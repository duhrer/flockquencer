<html>
<head>
    <title>Flockquencer</title>

    <script src="node_modules/infusion/dist/infusion-all.js"></script>
    <script src="node_modules/flocking/dist/flocking-all.js"></script>
    <!-- Bergson dependencies -->
    <script src="node_modules/bergson/dist/bergson-only.js"></script>

    <script src="node_modules/flocking/src/ui/selectbox/js/selectbox.js"></script>
    <script src="node_modules/flocking/src/ui/midi/midi-port-selector/js/midi-port-selector.js"></script>
    <script src="node_modules/flocking/src/ui/midi/midi-connector/js/midi-connector.js"></script>
    <script src="node_modules/flocking-midi-router/src/midi-router.js"></script>
    <script src="node_modules/flocking-midi-router/src/ui/browser-router.js"></script>
    <script src="src/js/offsets.js"></script>
    <script src="src/js/colours.js"></script>
    <script src="src/js/mode.js"></script>
    <script src="src/js/onscreen-svg.js"></script>
    <script src="src/js/onscreen.js"></script>
    <script src="src/js/performance-mode.js"></script>
    <script src="src/js/mode-controls.js"></script>
    <script src="src/js/connector.js"></script>
    <script src="src/js/router.js"></script>
    <script src="src/js/sequence.js"></script>
    <script src="src/js/sequence-player.js"></script>
</head>
<body>
    <div class="flockquencer-onscreen" align="center">
    </div>

    <hr/>

    <p>Connect your launchpad to this router (first and third settings).  Connect whatever you want to play to the second dropdown.</p>

    <div class="flockquencer">
        <div class="control-input"></div>
        <div class="control-output"></div>
        <div class="ui-output"></div>
    </div>

    <script type="text/javascript">
        var router = flockquencer.router(".flockquencer", {
            sequenceTemplates: {
                8:   {
                    length: 1,
                    steps: {
                        0: {
                            notes: [88]
                        }
                    }
                },
                24:  {
                    length: 2,
                    steps: {
                        0: {
                            notes: [76]
                        }
                    }
                },
                40:  {
                    length: 3,
                    steps: {
                        0: {
                            notes: [64]
                        },
                        2: {
                            notes: [64]
                        }
                    }

                },
                // S-O-S in morse:
                // S: 1 on, 1 off, 1 on, 1 off, 1 on                      =  5 beats
                // three beats pause between letter                       =  3 beats
                // O: 3 on (tied), 1 off, 3 on (tied), 1 off, 3 on (tied) = 11 beats
                // three beats pause between letter                       =  3 beats
                // S: 1 on, 1 off, 1 on, 1 off, 1 on                      =  5 beats
                // seven beats pause before reset                         =  7 beats
                //                                                        = 34 beats total
                56:  {
                    length: 34,
                    steps: {
                        0: {
                            notes: [96]
                        },
                        2: {
                            notes: [96]
                        },
                        4: {
                            notes: [96]
                        },
                        8: {
                            notes: [96]
                        },
                        9: {
                            tied: true,
                            notes: [96]
                        },
                        10: {
                            tied: true,
                            notes: [96]
                        },
                        12: {
                            notes: [96]
                        },
                        13: {
                            tied: true,
                            notes: [96]
                        },
                        14: {
                            tied: true,
                            notes: [96]
                        },
                        16: {
                            notes: [96]
                        },
                        17: {
                            tied: true,
                            notes: [96]
                        },
                        18: {
                            tied: true,
                            notes: [96]
                        },
                        22: {
                            notes: [96]
                        },
                        24: {
                            notes: [96]
                        },
                        26: {
                            notes: [96]
                        }
                    }
                },
                72:  {},
                88:  {},
                // Minor chord plus octave, in the style of a guitar
                104: {
                    length: 12,
                    steps: {
                        0: {
                            notes: [50]
                        },
                        1: {
                            tied: true,
                            notes: [50, 57]
                        },
                        2: {
                            tied: true,
                            notes: [50, 57, 62]
                        },
                        3: {
                            tied: true,
                            notes: [50, 57, 62, 64]
                        },
                        4: {
                            tied: true,
                            notes: [50, 57, 62, 64]
                        },
                        5: {
                            tied: true,
                            notes: [50, 57, 62, 64]
                        },
                        6: {
                            tied: true,
                            notes: [50, 57, 62, 64]
                        },
                        7: {
                            tied: true,
                            notes: [50, 57, 62, 64]
                        },
                        8: {
                            tied: true,
                            notes: [50, 57, 62, 64]
                        },
                        9: {
                            tied: true,
                            notes: [50, 57, 62, 64]
                        },
                        10: {
                            tied: true,
                            notes: [50, 57, 62, 64]
                        },
                        11: {
                            tied: true,
                            notes: [50, 57, 62, 64]
                        }
                    }
                },
                // Major chord plus octave, in the style of a guitar
                120: {
                    length: 12,
                    steps: {
                        0: {
                            notes: [50]
                        },
                        1: {
                            tied: true,
                            notes: [50, 57]
                        },
                        2: {
                            tied: true,
                            notes: [50, 57, 62]
                        },
                        3: {
                            tied: true,
                            notes: [50, 57, 62, 65]
                        },
                        4: {
                            tied: true,
                            notes: [50, 57, 62, 65]
                        },
                        5: {
                            tied: true,
                            notes: [50, 57, 62, 65]
                        },
                        6: {
                            tied: true,
                            notes: [50, 57, 62, 65]
                        },
                        7: {
                            tied: true,
                            notes: [50, 57, 62, 65]
                        },
                        8: {
                            tied: true,
                            notes: [50, 57, 62, 65]
                        },
                        9: {
                            tied: true,
                            notes: [50, 57, 62, 65]
                        },
                        10: {
                            tied: true,
                            notes: [50, 57, 62, 65]
                        },
                        11: {
                            tied: true,
                            notes: [50, 57, 62, 65]
                        }
                    }
                }
            },
            model: {
                sequences: {
                    8:   "@expand:flockquencer.sequence.mergeWithDefaults({that}.options.sequenceTemplates.8)",
                    24:  "@expand:flockquencer.sequence.mergeWithDefaults({that}.options.sequenceTemplates.24)",
                    40:  "@expand:flockquencer.sequence.mergeWithDefaults({that}.options.sequenceTemplates.40)",
                    56:  "@expand:flockquencer.sequence.mergeWithDefaults({that}.options.sequenceTemplates.56)",
                    72:  "@expand:flockquencer.sequence.mergeWithDefaults({that}.options.sequenceTemplates.72)",
                    88:  "@expand:flockquencer.sequence.mergeWithDefaults({that}.options.sequenceTemplates.88)",
                    104: "@expand:flockquencer.sequence.mergeWithDefaults({that}.options.sequenceTemplates.104)",
                    120: "@expand:flockquencer.sequence.mergeWithDefaults({that}.options.sequenceTemplates.120)"
                }
            }
        });
    </script>
</body>
</html>
